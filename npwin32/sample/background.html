<html>
<head>
<script>
function foo()
{
	try{
		var plugin = document.getElementById("p");
		var GetDiskFreeSpace = plugin.import( "kernel32.dll", "GetDiskFreeSpaceW", "WPPPP", "B" );
		var GetWindowsDirectory = plugin.import( "kernel32.dll", "GetWindowsDirectoryW", "WN", "N" );
		var MessageBox = plugin.import( "user32.dll", "MessageBoxW", "NWWN", "N" );
		var r = "";

		if( GetDiskFreeSpace ){
			var SectorsPerCluster = 0, BytesPerSector = 0, NumberOfFreeClusters = 0, TotalNumberOfClusters = 0;
			if( GetDiskFreeSpace.call( "C:\\", SectorsPerCluster, BytesPerSector, NumberOfFreeClusters, TotalNumberOfClusters ) ){
				r = "SectorsPerCluster:" + GetDiskFreeSpace.arg( 1 ) + "\nBytesPerSector:" + GetDiskFreeSpace.arg( 2 ) +
					"\nNumberOfFreeClusters:" + GetDiskFreeSpace.arg( 3 ) + "\nTotalNumberOfClusters:" + GetDiskFreeSpace.arg( 4 );
			};
		}

		var buf = new Array( 257 ).join( " " );// space * 256

		if( GetWindowsDirectory && MessageBox ){
			GetWindowsDirectory.call( buf, buf.length );
			r += "\nWindows directory:'" + GetWindowsDirectory.arg( 0 ) + "'";
			MessageBox.call( 0, r, "Chrome", 0 );
		}
	}
	catch(e ){
		alert( e );
	}
}

</script>
</head>
<body>
	<embed type="application/x-win32api-dynamic-call" id="p" hidden="true" />
</body>
</html>

